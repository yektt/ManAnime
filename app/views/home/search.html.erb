<nav class="navbar navbar-expand-lg container mt-2" id="search_bar">
  <div class="collapse navbar-collapse  flex-nowrap">
    <div class="flex-grow-1">
      <%= form_tag search_path, method: :get do %>
        <%= label_tag(:q, 'Search term', class: 'sr-only') %>
        <%= text_field_tag(:q, params[:q], class: 'form-control', placeholder:'Search with name, relase date or genre') %>
        <%= submit_tag('Search', class: 'btn btn-primary sr-only') %>
      <% end %>
    </div>

    <div class="d-flex flex-row ml-2">
      <div class="has-dropdown mr-2 align-self-center">
        <button class="btn btn-white ml-1" type="submit">
          <% if(params[:season])%>
            <%= params[:season].upcase_first %>
          <% else %>
            Seasons
          <% end %>
          <svg class="icon-downArrow ml-2" role="presentation">
            <use xlink:href="<%= asset_url("icons/icons-defs.svg" + "#down_arrow" ) %>"></use>
          </svg>
        </button>
       
        <ul class="dropdown ml-2 pl-1 pr-1">
          <li class="mt-1">
          <%= form_tag search_path, method: :get do %>
            <%= label_tag(:season, 'Winter', class:'sr-only') %>
            <%= text_field_tag(:season, 'winter', class: 'form-control sr-only') %>
            <%= submit_tag('Winter', type:'submit') %>
          <% end %>
          </li>
          <li>
          <%= form_tag search_path, method: :get do %>
            <%= label_tag(:season, 'Spring', class:'sr-only') %>
            <%= text_field_tag(:season, 'spring', class: 'form-control sr-only') %>
            <%= submit_tag('Spring', type:'submit') %>
          <% end %>
          </li>
          <li>
          <%= form_tag search_path, method: :get do %>
            <%= label_tag(:season, 'Summer', class:'sr-only') %>
            <%= text_field_tag(:season, 'summer', class: 'form-control sr-only') %>
            <%= submit_tag('Summer', type:'submit') %>
          <% end %>
          </li>
          <li class="mb-1">
          <%= form_tag search_path, method: :get do %>
            <%= label_tag(:season, 'Autumn', class:'sr-only') %>
            <%= text_field_tag(:season, 'autumn', class: 'form-control sr-only') %>
            <%= submit_tag('Autumn', type:'submit', class:'flex-grow-1') %>
          <% end %>
          </li>
        </ul>
      </div>
      <div>
        <button id="advanced_search_button" class="btn btn-white" type="submit">Advanced Search</button>
      </div>
    </div>
</nav>

<div id='advanced_search' class="container d-none">
  <h4 class="mt-3">Genres:</h4>
  <div id="genres" class="col-md-12 row">
    <% for genre in Genre.all.order(name: :asc) %>
      <div class="col-md-2 p-0 mt-2">
        <%= check_box_tag "genres_id[]", genre.id, false%> 
        <%= genre.name %> 
      </div>
    <% end %>
  </div>
  <h4 class="mt-3">Search starting from:</h4>
  <div id="years" class="col-md-12 row">
    <% @years.each do |year| %>
      <div class="col-md-2 p-0 mt-2">
        <%= check_box_tag "years[]", false%> 
        <%= year %> 
      </div>
    <% end %>
  </div>
</div>

<% unless (params[:q].nil?) %>
  <% unless( @animes.empty? && @mangas.empty?) %>
    <% unless(@animes.empty? || @animes.nil?) %>
      <%= render partial: 'display_5content', locals: { category: 'Result', content: @animes, search_term: params[:q] } %>
    <% else %>
      <h3 class="mt-4 ml-3"> No result found for '<%= params[:q] %>' in Animes! </h3>
    <% end %>
    <% unless(@mangas.empty? || @mangas.nil?) %>
      <%= render partial: 'display_5content', locals: { category: 'Result', content: @mangas, search_term: params[:q] } %>
    <% else %>
      <h3 class="mt-4 ml-3"> No result found for '<%= params[:q] %>' in Mangas! </h3>
    <% end %>
  <% else %>
    <h3 class="mt-4 container"> I couldn't find '<%= params[:q] %>' in anywhere! </h3>
  <% end %>
<% end %>

<% unless (params[:season].nil?) %>
  <% unless( @animes.empty? && @mangas.empty?) %>
    <% unless(@animes.empty? || @animes.nil?) %>
      <%= render partial: 'display_5content', locals: { category: 'Season', content: @animes, search_term: params[:season] } %>
    <% else %>
      <h3 class="mt-4 ml-3"> There is no <%= params[:season] %> season animes! </h3>
    <% end %>
    <% unless(@mangas.empty? || @mangas.nil?) %>
      <%= render partial: 'display_5content', locals: { category: 'Season', content: @mangas, search_term: params[:season] } %>
    <% else %>
      <h3 class="mt-4 ml-3"> There is no <%= params[:season] %> season mangas! </h3>
    <% end %>
  <% else %>
    <h3 class="mt-4 container"> I couldn't find anything for <%= params[:season] %> season! </h3>
  <% end %>
<% end %>
